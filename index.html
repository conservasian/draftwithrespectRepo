<!DOCTYPE html>
<html>
<head>
<title>Draft With Respect</title>
  <link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script type="text/javascript" src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-97066876-1', 'auto');
  ga('send', 'pageview');
</script>

  
  <style type="text/css">
    .jumbotron {
        background: #532f8c;
        color: white;
        padding-bottom: 80px
    }
    .jumbotron .btn-primary {
        background: #845ac7;
        border-color: #845ac7
    }
    .jumbotron .btn-primary:hover {
        background: #7646c1
    }
    .jumbotron p {
        color: #d9ccee;
        max-width: 75%;
        margin: 1em auto 2em
    }
    .navbar+.jumbotron {
        margin-top: -20px
    }
    .jumbotron .lang-logo {
        display: block;
        background: #b01302;
        border-radius: 50%;
        overflow: hidden;
        width: 100px;
        height: 100px;
        margin: auto;
        border: 2px solid white
    }
    .jumbotron .lang-logo img {
        max-width: 100%
    }

    .profile {
        background: #ffe3aa;
    }

  </style>
</head>
<body>
<nav class="navbar navbar-default navbar-static-top navbar-inverse">
  <div class="container">
    <ul class="nav navbar-nav">
      <li class="active">
        <a href="/"><span class="glyphicon glyphicon-home"></span> Home</a>
      </li>
  </div>
</nav>

<div class="jumbotron text-center">
  <div class="container">
    <h1>#draftwithrespect</h1>
    <p>A resource for the fans that want the best players, on the field and off the field</p>
	<form class="form-inline" id="playerInput">
	  	<div class="form-group">
    	<label for="playerInputBox">Search by name:</label>
   		<input type="text" class="form-control" id="playerInputBox" placeholder="">
	    </div>
        <button name="submit" type="submit" class="btn btn-default">Search</button>
	</form>
  </div>
</div>
<div class="container">
	<div class="row">
		<div id="profile_div" class="col-md-4">
			<h2 id="name"></h2>
			<p id="positionteam"></p>
		</div>
		<div class="col-md-8">
			<h3><span id="status"></span></h3>
			<p id="details"></p>
			<p id="links"></p>
		</div>
	</div>
</div>
<div class="container">
  <hr>
  <div class="row">
    <div class="col-md-6">
      <h3><span class="glyphicon glyphicon-info-sign"></span> How this sample app works</h3>
      <ul>
        <li>This app was deployed to Heroku, either using Git or by using <a href="https://github.com/heroku/python-getting-started">Heroku Button</a> on the repository.</li>

        <li>When Heroku received the source code, it fetched all the dependencies in the <a href="https://github.com/heroku/python-getting-started/blob/master/requirements.txt">requirements.txt file</a>, creating a deployable slug.</li>
        <li>The platform then spins up a dyno, a lightweight container that provides an isolated environment in which the slug can be mounted and executed.</li>
        <li>You can scale your app, manage it, and deploy over <a href="https://addons.heroku.com/">150 add-on services</a>, from the Dashboard or CLI.</li>
      </ul>
    </div>
    <div class="col-md-6">
      <h3><span class="glyphicon glyphicon-link"></span> Next Steps</h3>
      <ul>
        <li>If you are following the <a href="https://devcenter.heroku.com/articles/getting-started-with-python">Getting Started</a> guide, then please head back to the tutorial and follow the next steps!</li>
        <li>If you deployed this app by deploying the Heroku Button, then in a command line shell, run:</li>
        <ul>
          <li><code>git clone https://github.com/heroku/python-getting-started.git</code> - this will create a local copy of the source code for the app</li>
          <li><code>cd python-getting-started</code> - change directory into the local source code repository</li>
          <li><code>heroku git:remote -a &lt;your-app-name></code> - associate the Heroku app with the repository</li>
          <li>You'll now be set up to run the app locally, or <a href="https://devcenter.heroku.com/articles/getting-started-with-python#push-local-changes">deploy changes</a> to Heroku</li>
        </ul>
      </ul>
    </div>
  </div> <!-- row -->
   <div class="alert alert-info text-center" role="alert">
    Please do work through the Getting Started guide, even if you do know how to build such an application.  The guide covers the basics of working with Heroku, and will familiarize you with all the concepts you need in order to build and deploy your own apps.
  </div>
</div>

<script>
function findPlayerData(playerName, data, data2) {
	
	// find player name in incident data
	var names = []; 			
	for (i in data.incidents) {
	    names.push(data.incidents[i].Name)
    }
    var index = names.indexOf(playerName);

	// find player name in player team data    
    var names2 = []; 			
	for (i in data2.name_pos_team) {
	    names2.push(data2.name_pos_team[i].Name)
    }
    var index2 = names2.indexOf(playerName);
    
    // output data
    if (index == -1 && index2 == -1) {
    	return "not found in both"; }
    else if (index == -1 && index2 != -1) {
    	return "not found in incidents"
    }
	else {
		return [data.incidents[index].Name, data.incidents[index].Status, data.incidents[index].Link, data2.name_pos_team[index2].Position, data2.name_pos_team[index2].Team];
	}
}
</script>

<script>
$(document).ready(function(){

    $("#playerInput").submit(function(event){

		// clear data display elements
    	$("#name").empty();
    	$("#positionteam").empty();

    	$("#status").empty();
		$("#status").removeClass();
    	$("#details").empty();
    	$("#links").empty();

		// load incident and player team data
		var incidents_json = (function() {
			var incidents_json = null;
			$.ajax({
				'async': false,
				'global': false,
				'url': "incidents.json",
				'dataType': "json",
				'success': function (data) {
					incidents_json = data;
				}
			});
			return incidents_json;
	    })();
	    
	    var playerTeams_json = (function() {
			var playerTeams_json = null;
			$.ajax({
				'async': false,
				'global': false,
				'url': "playerTeams.json",
				'dataType': "json",
				'success': function (data) {
					playerTeams_json = data;
				}
			});
			return playerTeams_json;
	    })();

		// process query based on player name
        var playerName = $("#playerInputBox").val();
        playerName = playerName.trim();
		var result = findPlayerData(playerName, incidents_json, playerTeams_json);

		// display data
		$("#profile_div").addClass("profile"); 		
		$("#name").append(playerName);
		
		if (result == "not found in both") {
			$("#status").addClass("label label-default");
			$("#status").append("Not in database");
			$("#links").append("We haven't had time to research this player yet -- stay tuned for updates.");

		} else if (result == "not found in incidents") { 
			$("#status").addClass("label label-default");
			$("#status").append("Not in database");
			$("#links").append("We haven't had time to research this player yet -- stay tuned for updates.");		
			$("#positionteam").append(result[3] + "<br>" + result[4]);

		} else {

			$("#positionteam").append(result[3] + "<br>" + result[4]);
		
			if (result[1] == "No records found") {
				$("#status").addClass("label label-success");
				$("#status").append(result[1]);
				$("#links").append("We thoroughly searched and couldn't find any relevant records online.");
				
			} else {
			
				if (result[1] == "Arrested, not charged" || result[1] == "Accused, not charged") {
					$("#status").addClass("label label-warning"); 
				} else if (result[1] == "Pleaded guilty") {
					$("#status").addClass("label label-danger"); 
				}	
					
				$("#status").append(result[1]);
			
				if (result[2].includes("npr")) {
					$("#links").append("<a href='" + result[2] + "'>NPR</a>");
				} else if (result[2].includes("espn")) {
					$("#links").append("<a href='" + result[2] + "'>ESPN</a>");
				} else if (result[2].includes("sbnation")) {
					$("#links").append("<a href='" + result[2] + "'>SBNation</a>");
				} else {
					$("#links").append(result[2]);
				}
				
			}
			
        }
        event.preventDefault();
    });
});
</script>


</body>
</html>